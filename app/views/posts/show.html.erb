<%= provide(:title, "投稿詳細") %>
<div class="detailed-post">
  <div class="container pt-md-5">
    <div class="row pt-md-5">
      <div class="col-md-2">
        <h1>投稿詳細</h1>
      </div>
      <div class="detail mt-lg-5 col-md-6">
          <div class="animal-name">
            <h2 class="mt-3"><%= @post.found_animal %></h2>
          </div>
          <div class="nickname mb-3">
            <%= link_to @post.user.nickname, user_path(@post.user_id), class: "link-to" %>
          </div>
          <div class="post-image ml-lg-3 mb-3">
            <% if @post.image? %>
              <%= image_tag @post.image.url %>
            <% else %>
              <%= image_tag 'noimage.png', class: "noimage" %>
            <% end %>
          </div>
          <div class="date-and-place mb-3">
            <span><%= @post.found_date.year %>年</span>
            <span><%= @post.found_date.month %>月</span>
            <span><%= @post.prefecture.prefecture %></span>
          </div>
          <% if @post.latitude && @post.longitude %>
            <div id='show-gmap'></div>
          <% end %>
          <div class="content mb-3">
            <p class=""><%= @post.content %></p>
          </div>
          <div class="favorite">
            <div id="likes_buttons_<%= @post.id %>">
              <%= render partial: 'likes/like', locals: { post: @post }%>
            </div>
          </div>
      </div>
    </div>
  </div>
  <div class="container mb-md-5 pb-md-5">
    <div class="row mb-md-5">
      <div class="col-md-2">
      </div>
      <div class="detail comments pt-3 col-md-6">
        <h5>コメント</h5>
        <% if user_signed_in? && @comments.any? %>
          <%= render 'comments/comment' %>
          <%= render 'comments/form' %>
        <% elsif user_signed_in? %>
          <%= render 'comments/form' %>
        <% elsif !user_signed_in? && @comments.any? %>
          <%= render 'comments/comment' %>
          <p>ログインするとコメントができます</p>
        <% else %>
          <p>ログインするとコメントができます</p>
        <% end %>
      </div>
    </div>
  </div>
<style>
#show-gmap {
  height: 300px;
  width: 500px;
  margin-left: 1rem;
  margin-bottom: 2rem;
}
</style>

<script>
let map;
function initMap(){
  map = new google.maps.Map(document.getElementById('show-gmap'), {
    center: {lat:<%= @post.latitude %>, lng:<%= @post.longitude %>},
    zoom: 12,
  });

  let marker = new google.maps.Marker({
    position: map.getCenter(),
    map: map
  });

}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCwf221uzw_nqcoGVja1gAaxh3iKfdq8ec&callback=initMap" async defer></script>
</div>